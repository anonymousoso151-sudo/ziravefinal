# ุชุทุจูู ูุฎุทุท ูุงุนุฏุฉ ุงูุจูุงูุงุช - ZฤฐRAVE Platform

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงูุฏููู ููุถุญ ููููุฉ ุชุทุจูู ูุฎุทุท ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏ ุนูู ูุดุฑูุน Supabase ุงูุฎุงุต ุจู.

## ๐๏ธ ุงููุฎุทุท ุงููุทููุจ

ุชู ุฅูุดุงุก ููู ุงููุฌุฑุฉ ุงูุชุงูู:
- **ุงูููู:** `supabase/migrations/20250825052230_initial_zirave_schema.sql`
- **ุงููุตู:** ูุฎุทุท ุดุงูู ููุงุนุฏุฉ ุจูุงูุงุช ZฤฐRAVE

## ๐ ููููุฉ ุงูุชุทุจูู

### ุงูุทุฑููุฉ 1: ุงุณุชุฎุฏุงู Supabase CLI (ููุตู ุจูุง)

```bash
# ุงูุงูุชูุงู ุฅูู ูุฌูุฏ ุงููุดุฑูุน ุงูุฑุฆูุณู
cd /path/to/zirave-main

# ุชุทุจูู ุฌููุน ุงููุฌุฑุงุช ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ
npx supabase db reset

# ุฃู ุชุทุจูู ุงููุฌุฑุงุช ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุจุนูุฏุฉ
npx supabase db push
```

### ุงูุทุฑููุฉ 2: ุงุณุชุฎุฏุงู ููุญุฉ ุงูุชุญูู

1. ุงุฐูุจ ุฅูู [Supabase Dashboard](https://supabase.com/dashboard)
2. ุงุฎุชุฑ ูุดุฑูุนู
3. ุงุฐูุจ ุฅูู **SQL Editor**
4. ุงูุณุฎ ูุญุชูู ููู ุงููุฌุฑุฉ ูุงูุตูู
5. ุงุถุบุท **Run** ูุชุทุจูู ุงููุฎุทุท

### ุงูุทุฑููุฉ 3: ุงุณุชุฎุฏุงู psql ูุจุงุดุฑุฉ

```bash
# ุชุทุจูู ุงููุฎุทุท ูุจุงุดุฑุฉ ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
psql -h hybjjzpibecoqdqbumzn.supabase.co -U postgres -d postgres -f supabase/migrations/20250825052230_initial_zirave_schema.sql
```

## ๐ ุงูุฌุฏุงูู ุงูููุดุฃุฉ

### 1. **profiles** - ูููุงุช ุงููุณุชุฎุฏููู
- ูุฑุชุจุท ุจู `auth.users`
- ูุญุชูู ุนูู: ุงูุงุณูุ ุงูุฏูุฑุ ุฑูู ุงููุงุชูุ ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ
- ุงูุฃุฏูุงุฑ: FARMER, SUPPLIER, DRIVER, ENGINEER

### 2. **products** - ุงูููุชุฌุงุช
- ูุฑุชุจุท ุจู `profiles` (ุงูููุฑุฏ)
- ูุญุชูู ุนูู: ุงูุงุณูุ ุงููุตูุ ุงูุณุนุฑุ ุงููุฆุฉุ ุงููููุฉ ุงููุชููุฑุฉ

### 3. **conversations** - ุงููุญุงุฏุซุงุช
- ุชุฑุจุท ุจูู ูุณุชุฎุฏููู
- ุชุญุชูู ุนูู ุขุฎุฑ ุฑุณุงูุฉ ูุชุงุฑูุฎูุง

### 4. **messages** - ุงูุฑุณุงุฆู
- ูุฑุชุจุท ุจู `conversations`
- ูุฏุนู ุฃููุงุน ูุฎุชููุฉ: ูุตุ ุตูุฑุฉุ ููู

### 5. **shipment_requests** - ุทูุจุงุช ุงูููู
- ูุฑุชุจุท ุจู `profiles` (ููุฏู ุงูุทูุจ)
- ูุญุชูู ุนูู: ุงูุนููุงูุ ุงููุตูุ ุงูููุฒุงููุฉุ ุงูุชูุงุฑูุฎ

### 6. **shipment_bids** - ุนุฑูุถ ุงูููู
- ูุฑุชุจุท ุจู `shipment_requests` ู `profiles` (ุงููุฒุงูุฏ)
- ูุญุชูู ุนูู: ุงููุจูุบุ ุงูุฑุณุงูุฉุ ุงูุญุงูุฉ

### 7. **diagnosis_results** - ูุชุงุฆุฌ ุงูุชุดุฎูุต
- ูุฑุชุจุท ุจู `profiles` (ุงููุณุชุฎุฏู)
- ูุญุชูู ุนูู: ููุน ุงููุจุงุชุ ุงููุดุงูู ุงูููุชุดูุฉุ ุงูุชูุตูุงุช

### 8. **notifications** - ุงูุฅุดุนุงุฑุงุช
- ูุฑุชุจุท ุจู `profiles` (ุงููุณุชุฎุฏู)
- ูุฏุนู ุฃููุงุน ูุฎุชููุฉ ูู ุงูุฅุดุนุงุฑุงุช

## ๐ ุณูุงุณุงุช ุงูุฃูุงู (RLS)

ุชู ุชูุนูู Row Level Security ุนูู ุฌููุน ุงูุฌุฏุงูู ูุน ุงูุณูุงุณุงุช ุงูุชุงููุฉ:

### **profiles**
- โ ูููู ููุฌููุน ูุฑุงุกุฉ ุงููููุงุช ุงูุดุฎุตูุฉ
- โ ูููู ูููุณุชุฎุฏููู ุชุนุฏูู ูููุงุชูู ุงูุดุฎุตูุฉ ููุท

### **products**
- โ ูููู ููุฌููุน ูุฑุงุกุฉ ุงูููุชุฌุงุช ุงููุดุทุฉ
- โ ูููู ููููุฑุฏูู ุฅุฏุงุฑุฉ ููุชุฌุงุชูู ููุท

### **conversations & messages**
- โ ูููู ูููุณุชุฎุฏููู ุงููุตูู ูููุญุงุฏุซุงุช ุงูุชู ูุดุงุฑููู ูููุง ููุท

### **shipment_requests & shipment_bids**
- โ ูููู ููุฌููุน ุฑุคูุฉ ุงูุทูุจุงุช ุงููุดุทุฉ
- โ ูููู ูููุณุชุฎุฏููู ุฅุฏุงุฑุฉ ุทูุจุงุชูู ูุนุฑูุถูู ููุท

### **diagnosis_results & notifications**
- โ ูููู ูููุณุชุฎุฏููู ุงููุตูู ูุจูุงูุงุชูู ููุท

## ๐ง ุงูููุฒุงุช ุงูุฅุถุงููุฉ

### **Triggers ุงูุชููุงุฆูุฉ**
- ุชุญุฏูุซ `updated_at` ุชููุงุฆูุงู
- ุฅูุดุงุก ููู ุดุฎุตู ุนูุฏ ุชุณุฌูู ูุณุชุฎุฏู ุฌุฏูุฏ
- ุชุญุฏูุซ ุขุฎุฑ ุฑุณุงูุฉ ูู ุงููุญุงุฏุซุฉ ุชููุงุฆูุงู

### **Indexes ููุฃุฏุงุก**
- ููุงุฑุณ ุนูู ุฌููุน ุงูุฃุนูุฏุฉ ุงููููุฉ ููุจุญุซ
- ููุงุฑุณ ุนูู ุงูุนูุงูุงุช ุงูุฎุงุฑุฌูุฉ

### **Data Validation**
- ูุญูุตุงุช ุนูู ุงูุฃุณุนุงุฑ ูุงูุฃูุฒุงู
- ูููุฏ ุนูู ุงูุชูุงุฑูุฎ
- ุฃููุงุน ุจูุงูุงุช ูุฎุตุตุฉ (ENUMs)

## ๐ ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ

ุชู ุฅุฏุฑุงุฌ ุจูุงูุงุช ุชุฌุฑูุจูุฉ ุชุดูู:
- 4 ูุณุชุฎุฏููู ุจุฃุฏูุงุฑ ูุฎุชููุฉ
- 3 ููุชุฌุงุช ุชุฌุฑูุจูุฉ

## โ ุงูุชุญูู ูู ุงูุชุทุจูู

ุจุนุฏ ุชุทุจูู ุงููุฎุทุทุ ููููู ุงูุชุญูู ูู ูุฌุงุญ ุงูุนูููุฉ:

```bash
# ุชุดุบูู ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
cd backend-custom
npm run test:db
```

### ุงููุชูุฌุฉ ุงููุชููุนุฉ:
```
โ ูุฌุญ ุงููุตูู ูุฌุฏูู profiles
๐ ุนุฏุฏ ุงููููุงุช ุงูุดุฎุตูุฉ: 4
โ ูุฌุญ ุงููุตูู ูุฌุฏูู products
๐ ุนุฏุฏ ุงูููุชุฌุงุช: 3
```

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดููุฉ: "relation already exists"
**ุงูุญู:** ุงุณุชุฎุฏู `npx supabase db reset` ูุฅุนุงุฏุฉ ุชุนููู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ูุดููุฉ: "permission denied"
**ุงูุญู:** ุชุฃูุฏ ูู ุฃู ูุฏูู ุตูุงุญูุงุช ูุงููุฉ ูู ูุดุฑูุน Supabase

### ูุดููุฉ: "invalid syntax"
**ุงูุญู:** ุชุญูู ูู ุฅุตุฏุงุฑ PostgreSQL (ูุฌุจ ุฃู ูููู 12 ุฃู ุฃุญุฏุซ)

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุญูู ูู ุณุฌูุงุช Supabase
2. ุชุฃูุฏ ูู ุตุญุฉ ููุงุชูุญ API
3. ุฑุงุฌุน ูุซุงุฆู Supabase ุงูุฑุณููุฉ

## ๐ ุฑูุงุจุท ูููุฏุฉ

- [Supabase Documentation](https://supabase.com/docs)
- [PostgreSQL Documentation](https://www.postgresql.org/docs/)
- [Row Level Security Guide](https://supabase.com/docs/guides/auth/row-level-security)
